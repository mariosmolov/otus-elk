# otus-elk
Настраиваем центральный сервер для сбора логов
в вагранте поднимаем 2 машины web и log
на web поднимаем nginx
на log настраиваем центральный лог сервер на любой системе на выбор
- journald
- rsyslog
- elk
настраиваем аудит следящий за изменением конфигов нжинкса

все критичные логи с web должны собираться и локально и удаленно
все логи с nginx должны уходить на удаленный сервер (локально только критичные)
логи аудита должны также уходить на удаленную систему

# Работоспособность

Поднимаем кластер `vagrant up` и можно заварить кофе, ибо надо подождать

Заходим на web-хост `vagrant ssh web01` и делаем `curl 0.0.0.0:8080`, чтобы в логе nginx появилась хоть одна запись

Далее пробросим порт на наш компьютер `sudo ssh -N -L 5601:127.0.0.1:5601 vagrant@127.0.0.1 -p 2202`
Переходим по ссылке [Kibana](http://127.0.0.1:5601)

Добавим индекс filebeat и увидим следующее:

Пришел лог nginx

![1](https://github.com/mariosmolov/otus-elk/blob/master/Screenshot_1.png)

Посмортим правила auditd

![2](https://github.com/mariosmolov/otus-elk/blob/master/Screenshot_3.png)

И увидим что его лог тоже распарсился

![3](https://github.com/mariosmolov/otus-elk/blob/master/Screenshot_2.png)

# P.S.

У меня не взлетало на 2гб оперативы версия 7.х(а больше выделить не мог, на пк для заданий всего 6). Погуглил и нашел на гите эту сборку, где используется 5.6 версия и вот со zram сжимают всё дело. Взлетело

# P.S.S.

В работе используется ELK-стек, крайне крутая вещь. С помошью filebeat отправляется все на парсер Logstash, который разбирает по полям и закидывает в базу Elastic. В Kibana же мы видим как это дело отображается
